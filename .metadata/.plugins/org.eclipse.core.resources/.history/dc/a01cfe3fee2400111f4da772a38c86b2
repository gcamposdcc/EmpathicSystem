package cl.automind.empathy.fw.data.sql;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class SqlDescriptor {
	private Map<String, Map<String, Collection<Integer>>> queryPositionsMap;
	private String idName;
	private List<String> fieldNames;

	public SqlDescriptor(){
		setQueryPositionsMap(new HashMap<String, Map<String,Collection<Integer>>>());
		setFieldNames(new ArrayList<String>())
	}
	public void addQuery(String queryName){
		if (getQueryPositionsMap().containsKey(queryName)) return;
		getQueryPositionsMap().put(queryName, new HashMap<String, Collection<Integer>>());
	}
	public void addParamToQuery(String queryName, String param){
		addQuery(queryName);
		Map<String, Collection<Integer>> varPositionMap = getQueryPositionsMap().get(queryName);
		if (!varPositionMap.containsKey(param)) {
			varPositionMap.put(param, new ArrayList<Integer>());
		}
	}
	public void addParamToQuery(String queryName, String param, int position){
		Map<String, Collection<Integer>> varPositionMap = getQueryPositionsMap().get(queryName);
		if (varPositionMap != null){
			if (!varPositionMap.containsKey(param)) {
				varPositionMap.put(param, new ArrayList<Integer>());
			}
			Collection<Integer> positions =  varPositionMap.get(param);
			if(positions.contains(position)) return;
			positions.add(position);
		}
	}
	public Collection<Integer> getParamPosition(String queryName, String param){
		Map<String, Collection<Integer>> varPositionMap = getQueryPositionsMap().get(queryName);
		if (varPositionMap != null){
			if (varPositionMap.containsKey(param)) {
				return varPositionMap.get(param);
			}
		}
		return Collections.emptyList();
	}
	private void setQueryPositionsMap(Map<String, Map<String, Collection<Integer>>> queryPositionsMap) {
		this.queryPositionsMap = queryPositionsMap;
	}

	private Map<String, Map<String, Collection<Integer>>> getQueryPositionsMap() {
		return queryPositionsMap;
	}
	public void setIdName(String idName) {
		this.idName = idName;
	}
	public String getIdName() {
		return idName;
	}
	public void setFieldNames(List<String> fieldNames) {
		this.fieldNames = fieldNames;
	}
	public List<String> getFieldNames() {
		return fieldNames;
	}

}
